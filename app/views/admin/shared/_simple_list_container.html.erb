<div class='content company'>
	<ul class='list <%= p.object_label_plural.downcase %>'>
		<li class='search' title='Search <%= p.object_label_plural.capitalize %> List'><span class='admin-sprite icon'></span><input id="search-filter" value='Search <%= p.object_label_plural.capitalize %>' onfocus='if(this.value=="Search <%= p.object_label_plural.capitalize %>")value=""' onblur='if(this.value=="")this.value="Search <%= p.object_label_plural.capitalize %>"'/><%= render :partial => 'admin/shared/actions_bar' %></li>
		<div class="results">
			<%= p.list %>
		</div>
	</ul>
</div>

<script type="text/javascript" charset="utf-8">
	var filtered = false;
	$(document).ready(function(){
		$('#search-filter').keyup(function(){
			filter()
		})
	})
	function filter () {
		filtered = true;
		$.get('<%= url_for([:admin, @company, p.object.to_s.pluralize]) %>?ajax=true&search=' + $('#search-filter').val(), function(data){
			$('.results').html(data)
		})
	}
	function showAll () {
		var url = '<%= url_for([:admin, @company, p.object.to_s.pluralize]) %>?ajax=true&show_all=true';
		if (filtered) {
			url += "&search=" + $('#search-filter').val()
		}
		$.get(url, function(data){
			$('.results').html(data)
		})
	}
</script>